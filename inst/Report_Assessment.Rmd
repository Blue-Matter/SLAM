---
title: "`r data$type`"
subtitle: "`r data$Data$Metadata$Value[data$Data$Metadata$Field=='Author']`"
date: "`r ifelse(is.null(data$Data$Metadata$Value[data$Data$Metadata$Field=='Date']) | is.na(data$Data$Metadata$Value[data$Data$Metadata$Field=='Date']), Sys.Date(), data$Data$Metadata$Value[data$Data$Metadata$Field=='Date'])`"
---
<style type="text/css">
h1 { /* Header 1 */
  font-size: 24px;
}
</style>
```{r setup2, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

tab.num <<- fig.num <<- 0

fig.number <- function() {
  fig.num <<- fig.num + 1
  paste0('Figure ', fig.num, '.')
}
  
tab.number <- function() {
  tab.num <<- tab.num + 1
  paste0('Table ', tab.num , '.')
}
  

```


# {.tabset}
## Fishery Information

```{r}
knitr::kable(data$Data$Metadata, caption=paste(tab.number(), 'Fishery Information.'))
```

## Data {.tabset}
### At-Age Schedules  {.tabset}

```{r}
 weight_at_age <- report_weight_at_age(data$Data)
 colnames(weight_at_age$df)[3:4] <- c('10th', '90th')

 # Maturity-at-Age
 maturity_at_age <- report_maturity_at_age(data$Data)

 # M-at-Age
 M_at_age <- report_M_at_age(data$Data)

 # PSM-at-Age
 PSM <- report_PSM_at_age(data$Data)

 at_age_p <- cowplot::plot_grid(weight_at_age$p,
                                maturity_at_age$p,
                                M_at_age$p,
                                PSM$p)
 
 df <- dplyr::left_join(weight_at_age$df, maturity_at_age$df, by='Age')
 df <- dplyr::left_join(df, M_at_age$df, by='Age')
 df <- dplyr::left_join(df, PSM$df, by='Age')
 
```


####  Figures  
```{r, fig.width=8, }
at_age_p
```


####  Table  

```{r}
 knitr::kable(df, caption=paste(tab.number(), 'At-Age schedules.'))
```

### Catch-at-Weight

```{r, fig.width=8,fig.height=16}
 CAW <- report_CAW(data)
 CAW$p
```



### Index of Effort
```{r}
report_Effort_TS(data)

```

### Index of Abundance

```{r}
report_Index_TS(data)
```

## Assessment Results {.tabset}

### Tables 

```{r}
knitr::kable(assumed_pars(data),  caption=paste(tab.number(), 'Assumed parameters used in the assessment.'))
```

```{r}
DT::datatable(nll_vals(data),  caption=paste(tab.number(), 'Negative log-likelihood values.'),
                options = list(
    info = FALSE,
    paging = FALSE,
    searching = FALSE
  ))
```

### Seasonal Recruitment Pattern 
```{r, fig.cap=paste(fig.number(), 'The estimated seasonal recruitment pattern.')}
p <- report_seasonal_rec(data)
p$p

knitr::kable(p$df, caption=paste(tab.number(), 'The estimated seasonal recruitment pattern.'))
```

### Spawning Potential Ratio
### Estimated Parameters  






